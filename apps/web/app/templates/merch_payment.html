{% extends "base.html" %}

{% block content %}
  <section class="section">
    <article class="card card--spacious">
      <h1>Pagamento Nexi/XPay</h1>
      <p>Stiamo preparando la richiesta per: <strong>{{ item.name }}</strong></p>
      <p>Quantità: {{ quantity }}</p>
      <p>Totale: {{ total }} €</p>
      <div class="code-block">
        <p>Parametri di pagamento da inviare a Nexi/XPay:</p>
        <pre>{{ payment.payload | tojson(indent=2) }}</pre>
      </div>
      <div class="hero__actions">
        <form method="post" action="{{ payment.redirect_url }}">
          {% for name, value in payment.payload.items() %}
            <input type="hidden" name="{{ name }}" value="{{ value }}">
          {% endfor %}
          <button class="btn btn-primary" type="submit">
            Procedi al pagamento sicuro
          </button>
        </form>
        <a class="btn btn-secondary" href="/merch/{{ item.slug }}">Modifica ordine</a>
      </div>
      <p class="muted">
        Il pagamento utilizza il riferimento <code>{{ payment.payload.codTrans }}</code>.
        Puoi usare i parametri sopra come base per test aggiuntivi o per una integrazione
        server-to-server con Nexi/XPay.
      </p>
    </article>
  </section>
{% endblock %}
