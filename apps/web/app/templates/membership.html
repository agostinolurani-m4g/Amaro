{% extends "base.html" %}

{% block content %}
  <section class="section">
    <article class="card card--spacious">
      <h1>Tesseramento</h1>
      <p class="muted">
        La quota annuale è di <strong>{{ membership_fee }} €</strong> e include copertura assicurativa di base, accesso agli eventi
        sociali e alle attività sportive. Per completare la richiesta servono <strong>carta d'identità</strong>,
        <strong>tessera sanitaria</strong> e <strong>certificato medico</strong> in corso di validità, oltre al pagamento Nexi/XPay.
        Al termine riceverai una password per accedere all'area tesserati e consultare i documenti caricati.
      </p>
      {% if success %}
        <p class="alert alert--success">
          Grazie! Ti abbiamo inviato una conferma: completa il pagamento Nexi/XPay dal link dedicato.
        </p>
      {% endif %}
      <form method="post" enctype="multipart/form-data" class="form stacked">
        <div class="form-grid">
          <div>
            <label for="first_name">Nome</label>
            <input id="first_name" name="first_name" type="text" placeholder="Maria" required />
          </div>
          <div>
            <label for="last_name">Cognome</label>
            <input id="last_name" name="last_name" type="text" placeholder="Rossi" required />
          </div>
        </div>

        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="maria@esempio.com" required />

        <div class="form-grid">
          <div>
            <label for="birth_date">Data di nascita</label>
            <input id="birth_date" name="birth_date" type="date" required />
          </div>
          <div>
            <label for="birth_place">Luogo di nascita</label>
            <input id="birth_place" name="birth_place" type="text" placeholder="Udine" required />
          </div>
        </div>

        <div class="form-grid">
          <div>
            <label for="residence">Residenza</label>
            <input id="residence" name="residence" type="text" placeholder="Via Roma 1, Amaro" required />
          </div>
          <div>
            <label for="codice_fiscale">Codice fiscale</label>
            <input id="codice_fiscale" name="codice_fiscale" type="text" placeholder="RSSMRA80A01H501U" required />
          </div>
        </div>

        <div class="form-grid">
          <div>
            <label for="document_type">Tipo documento (CI/Passaporto)</label>
            <input id="document_type" name="document_type" type="text" placeholder="Carta d'identità" required />
          </div>
          <div>
            <label for="document_number">Numero documento</label>
            <input id="document_number" name="document_number" type="text" required />
          </div>
        </div>

        <div class="form-grid">
          <div>
            <label for="document_id">Codice tessera (se già assegnato)</label>
            <input id="document_id" name="document_id" type="text" />
          </div>
          <div>
            <label for="tessera_sanitaria">Tessera sanitaria</label>
            <input id="tessera_sanitaria" name="tessera_sanitaria" type="text" required />
          </div>
        </div>

        <label for="medical_certificate">Certificato medico (note)</label>
        <textarea id="medical_certificate" name="medical_certificate" rows="3" placeholder="Idoneità agonistica, ente rilasciante" required></textarea>

        <label for="medical_certificate_expiry">Scadenza certificato medico</label>
        <input id="medical_certificate_expiry" name="medical_certificate_expiry" type="date" required />

        <label for="membership_type">Tipologia</label>
        <select id="membership_type" name="membership_type" required>
          {% for option in membership_types %}
            <option value="{{ option }}">{{ option }}</option>
          {% endfor %}
        </select>

        <label for="message">Hai qualcosa da raccontarci?</label>
        <textarea id="message" name="message" rows="3" placeholder="Quali progetti ti interessano?"></textarea>

        <label for="documents">Documenti / immagini (PDF, JPG, PNG) - carica certificato, CI e tessera sanitaria</label>
        <input
          id="documents"
          name="documents"
          type="file"
          accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
          multiple
          required
        />

        <button class="btn btn-primary" type="submit">Invia dati e prosegui con Nexi/XPay</button>
      </form>
      <p class="muted">
        Gli allegati vengono salvati nella cartella {{ uploads_path }}. Dopo il pagamento riceverai la password per
        l'area tesserati, dove potrai cercare e scaricare i tuoi documenti.
      </p>
    </article>
  </section>
{% endblock %}
